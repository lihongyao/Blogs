# å‰è¨€

Vite æ˜¯ä¸€ä¸ªè¶…å¿«é€Ÿçš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œæ¨åŠ¨ç€ä¸‹ä¸€ä»£ç½‘ç»œåº”ç”¨çš„å‘å±•ã€‚

2024 å¹´ 11 æœˆ 26 æ—¥ï¼ŒVite 6.0 æ­£å¼å‘å¸ƒï¼Œæ ‡å¿—ç€ Vite è¿ˆå‘æ–°é˜¶æ®µçš„é‡è¦é‡Œç¨‹ç¢‘ï¼

> æç¤ºï¼šå…³äºViteçš„æ›´å¤šä»‹ç»ï¼Œè¯·ç§»æ­¥è‡³ [å®˜ç½‘ >>](https://cn.vite.dev/)

# æ­å»ºé¡¹ç›®

ç¯å¢ƒé…ç½®ï¼š

**`node`**ï¼š<mark>v22.11.0</mark>

**`pnpm`**ï¼š<mark>v10.3.0</mark>

**`vite`**ï¼š<mark>v6.1.0</mark>

```shell
# Vue
$ pnpm create vite <PROJECT-Name> --template vue-ts
# React
$ pnpm create vite <PROJECT-Name> --template react-ts
```

> ğŸ”– **æç¤º**
>
> - ä½ å¯ä»¥ä½¿ç”¨ `.` ä½œä¸ºé¡¹ç›®åç§°ï¼Œåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºé¡¹ç›®è„šæ‰‹æ¶ã€‚
>
> - å…³äºå¦‚ä½•åŸºäº Vite åˆ›å»ºé¡¹ç›®ï¼Œå¯ä»¥å‚è€ƒ [è¿™é‡Œ >>](https://cn.vite.dev/guide/#scaffolding-your-first-vite-project)ã€‚

# vite.config.js

@See https://cn.vitejs.dev/config/

é¦–å…ˆå®‰è£… Node.js æä¾›çš„ç±»å‹å®šä¹‰çš„åŒ… @types/nodeï¼Œè§£å†³ **æ‰¾ä¸åˆ°æ¨¡å— path æˆ–å…¶ç›¸å¯¹åº”çš„ç±»å‹å£°æ˜** çš„é—®é¢˜ã€‚

```shell
$ pnpm add -D @types/node
```

åŸºæœ¬é…ç½®å¦‚ä¸‹ï¼š

> ğŸ“– ***Vue.js***

```js
import { defineConfig, loadEnv } from "vite";
import vue from "@vitejs/plugin-vue";
export default defineConfig(({ mode }) => {
  const env = loadEnv(mode, process.cwd(), "VITE_");
  return {
    plugins: [vue()],
  };
});
```
> ğŸ“– ***React.js***
```ts
import type { UserConfig, ConfigEnv } from 'vite';
import { defineConfig, loadEnv } from "vite";
import react from "@vitejs/plugin-react";

// https://cn.vitejs.dev/config/
export default defineConfig(({ mode }: ConfigEnv): UserConfig => {
  const env = loadEnv(mode, process.cwd(), "VITE_");
  console.log(env)
  return {
    plugins: [react()],
  };
});
```

## å–åˆ«å

@See https://cn.vitejs.dev/config/shared-options.html#resolve-alias

åœ¨ `vite.config.ts` ä¸­é…ç½® `resolve.alias` ï¼Œä½¿ç”¨ `@` ç¬¦å·ä»£è¡¨ `src`ã€‚

> **`vite.config.js`**

```ts
import type { UserConfig, ConfigEnv } from 'vite';
import { defineConfig, loadEnv } from 'vite'
import { resolve } from 'node:path';
import react from '@vitejs/plugin-react'

// https://cn.vitejs.dev/config/
export default defineConfig(({ mode }: ConfigEnv): UserConfig => {

  // -- è·å–å½“å‰å·¥ä½œç›®å½•è·¯å¾„
  const root = process.cwd();
  const pathResolve = (path: string) => resolve(root, '.', path);
  // -- è·å–ç¯å¢ƒå˜é‡
  const env = loadEnv(mode, root, "VITE_");
  console.log(env);
  return {
    resolve: {
      alias: {
        "@": pathResolve('src'),
      },
    },
    plugins: [react()],
  };
});
```

> **`tsconfig.app.json`**

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    },
  },
}
```

> æç¤ºï¼šæ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚é…ç½®ï¼Œé€šå¸¸æ¥è¯´ï¼Œé…ç½® `@/` æŒ‡å‘ `src/*` ç›®å½•å³å¯ã€‚
>

## å¼€å‘æœåŠ¡å™¨é€‰é¡¹ & ä»£ç†

@See https://cn.vitejs.dev/config/server-options.html

```js
server: {
  host: "0.0.0.0",
  port: 8888,
  strictPort: false,
  open: true,
  cors: true,
  proxy: {},
}
```

## ç¯å¢ƒå˜é‡

@See https://cn.vitejs.dev/guide/env-and-mode.html

**â‘ . åœ¨æ ¹ç›®å½•æ–°å»º  `.env.development`ã€`.env.production`ã€`.env.test`**

```shell
$ touch .env.dev .env.prod .env.qa
```

å¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š

```ini
[env.dev]
# -- å¼€å‘ç¯å¢ƒ
VITE_ENV=dev;
# -- æ¥å£è¯·æ±‚åœ°å€
VITE_API_HOST=å¼€å‘ç¯å¢ƒæ¥å£è¯·æ±‚åœ°å€;
# -- æ‰“åŒ…è¾“å‡ºç›®å½•
VITE_OUT_DIR="dist"
# -- åŸºç¡€è·¯å¾„ï¼Œéƒ¨ç½²äºŒçº§ç›®å½•æ—¶å¡«å†™ï¼Œå¦‚ï¼š/my-app/
VITE_BASE=""

[.env.prod]
# -- ç”Ÿäº§ç¯å¢ƒ
VITE_ENV=prod;
# -- æ¥å£è¯·æ±‚åœ°å€
VITE_API_HOST=ç”Ÿäº§ç¯å¢ƒæ¥å£è¯·æ±‚åœ°å€;
# -- æ‰“åŒ…è¾“å‡ºç›®å½•
VITE_OUT_DIR="dist"
# -- åŸºç¡€è·¯å¾„ï¼Œéƒ¨ç½²äºŒçº§ç›®å½•æ—¶å¡«å†™ï¼Œå¦‚ï¼š/my-app/
VITE_BASE=""

[.env.qa]
# -- æµ‹è¯•ç¯å¢ƒ
VITE_ENV=qa;
# -- æ¥å£è¯·æ±‚åœ°å€
VITE_API_HOST=æµ‹è¯•ç¯å¢ƒæ¥å£è¯·æ±‚åœ°å€;
# -- æ‰“åŒ…è¾“å‡ºç›®å½•
VITE_OUT_DIR="dist"
# -- åŸºç¡€è·¯å¾„ï¼Œéƒ¨ç½²äºŒçº§ç›®å½•æ—¶å¡«å†™ï¼Œå¦‚ï¼š/my-app/
VITE_BASE=""
```

> âš ï¸ **æ³¨æ„**ï¼š
>
> 1. ç¯å¢ƒå˜é‡åå¿…é¡»ä»¥ `VITE_` å¼€å¤´ï¼›
>2. é…ç½®æ–‡ä»¶çš„å†…å®¹è¯·æ ¹æ®é¡¹ç›®éœ€è¦è®¾ç½®ï¼›

**â‘¡. ä¿®æ”¹ `package.json` æŒ‡ä»¤**

ä¸ºäº†ä½¿å‘½ä»¤åœ¨ Windows å’Œ macOS/Linux ä¸‹éƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [cross-env](https://www.npmjs.com/package/cross-env)ã€‚

```shell
$ pnpm add -D cross-env
```

> ğŸ“– ***Vue.js***

```json
{
  "scripts": {
    "dev": "cross-env VITE_CJS_IGNORE_WARNING=true vite --mode dev",
    "build:qa": "vue-tsc && vite build --mode qa",
    "build:prod": "vue-tsc && vite build --mode prod"
  }
}
```

> ğŸ“– ***React.js***

```
{
  "scripts": {
    "dev": "cross-env VITE_CJS_IGNORE_WARNING=true vite --mode dev",
    "build:qa": "tsc --noEmit && vite build --mode qa",
    "build:prod": "tsc --noEmit && vite build --mode prod"
  }
}
```

**â‘¢. é…ç½®TypeScript æ™ºèƒ½æç¤º**

> **`@/vite-env.d.ts`**

```ts
/// <reference types="vite/client" />

interface ImportMetaEnv {
  readonly VITE_ENV: string;
  readonly VITE_API_HOST: string;
  readonly VITE_OUT_DIR: string;
  readonly VITE_BASE: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```

**â‘£. ä½¿ç”¨ç¯å¢ƒå˜é‡**

```tsx
import.meta.env.VITE_API_HOST
```

## æ„å»ºç›¸å…³

@See https://cn.vitejs.dev/config/build-options.html

```ts
build: {
  // -- è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸º dist
  outDir: 'dist',
  // -- é™æ€èµ„æºçš„è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸º assets
  assetsDir: 'assets',
  // -- å°äºæ­¤é˜ˆå€¼çš„å¯¼å…¥æˆ–å¼•ç”¨èµ„æºå°†å†…è”ä¸º base64 ç¼–ç ï¼Œè®¾ç½®ä¸º 0 å¯ç¦ç”¨æ­¤é¡¹ï¼Œå•ä½ä¸ºå­—èŠ‚
  assetsInlineLimit: 4096,
  // -- å¯ç”¨/ç¦ç”¨ CSS ä»£ç æ‹†åˆ†ï¼Œé»˜è®¤ä¸º true
  cssCodeSplit: true,
  // -- æ„å»ºåæ˜¯å¦ç”Ÿæˆ source map æ–‡ä»¶ï¼Œé»˜è®¤ä¸º false
  sourcemap: false,
  // -- æ§åˆ¶æ„å»ºæ—¶æ˜¯å¦æ¸…ç©ºè¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸º true
  emptyOutDir: true,
  // -- æ§åˆ¶æ˜¯å¦å‹ç¼©æ„å»ºç»“æœï¼Œé»˜è®¤ä¸º true
  minify: "esbuild",
  // -- è®¾ç½®ç›®æ ‡æµè§ˆå™¨ï¼Œé»˜è®¤ä¸º Vite å†…éƒ¨çš„é»˜è®¤å€¼
  target: 'modules',
  // -- chunk å¤§å°è­¦å‘Šçš„é™åˆ¶ï¼ˆä»¥ kbs ä¸ºå•ä½ï¼‰
  chunkSizeWarningLimit: 2000,
  // -- å¯ç”¨/ç¦ç”¨ gzip å‹ç¼©å¤§å°æŠ¥å‘Š
  reportCompressedSize: false,
  ...
}
```

æ¨èé…ç½®ï¼š

```json
build: {
  outDir: env.VITE_OUT_DIR,
  chunkSizeWarningLimit: 2000,
  reportCompressedSize: false
}
```

## gzipå‹ç¼©æ‰“åŒ…

å®‰è£…ä¾èµ–ï¼š

```shell
$ pnpm add -D vite-plugin-compression
```

```tsx
import { defineConfig } from "vite";
import viteCompression from "vite-plugin-compression";

export default defineConfig({
  plugins: [
    // -- é»˜è®¤å‹ç¼© gzipï¼Œç”Ÿæˆ .gz æ–‡ä»¶
    viteCompression({
      // -- å‹ç¼©åæ˜¯å¦åˆ é™¤æºæ–‡ä»¶
      deleteOriginFile: false,
    }),
  ],
});
```

è¿è¡Œ `pnpm build` å‘½ä»¤ï¼ŒæŸ¥çœ‹ `dist` çš„ `assets` ç›®å½•ã€‚

> æç¤ºï¼šä¸ºäº†å……åˆ†åˆ©ç”¨ Gzip å‹ç¼©çš„ä¼˜åŠ¿ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿæ­£ç¡®åœ°æœåŠ¡ Gzip å‹ç¼©æ–‡ä»¶ï¼Œè¿™ä¸€æ­¥äº¤ç»™åç«¯æ¥å¤„ç†å³å¯ã€‚

## æµè§ˆå™¨å…¼å®¹

@See https://github.com/vitejs/vite/tree/main/packages/plugin-legacy

```shell
$ pnpm add @vitejs/plugin-legacy terser -D
```
> æç¤ºï¼šå¿…é¡»å®‰è£… `terser`ï¼Œå› ä¸º `legacy` éœ€è¦ä½¿ç”¨å®ƒæ¥è¿›è¡Œå‹ç¼©
```ts
// vite.config.js
import legacy from '@vitejs/plugin-legacy'

export default {
  plugins: [
    legacy({
      targets: ['defaults', 'not IE 11'],
    }),
  ],
}
```

## æ‰“åŒ…åˆ†æå¯è§†åŒ–

```shell
$ pnpm add -D rollup-plugin-visualizer
```

```ts
import { defineConfig } from "vite";
import { visualizer } from "rollup-plugin-visualizer";
export default defineConfig({
  plugins: [
    visualizer({
      // -- buildåï¼Œæ˜¯å¦è‡ªåŠ¨æ‰“å¼€åˆ†æé¡µé¢ï¼Œé»˜è®¤false
      open: true,
      // -- æ˜¯å¦åˆ†æ gzip å¤§å°
      gzipSize: true,
      // -- æ˜¯å¦åˆ†æ brotli å¤§å°
      brotliSize: true,
      // -- ç”Ÿæˆçš„å¯è§†åŒ–æŠ¥å‘Šæ–‡ä»¶å
      filename: 'stats.html',
    })
  ],
});
```

ä½¿ç”¨å‘½ä»¤ `pnpm build` åï¼Œåˆ†æå›¾ html æ–‡ä»¶ä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆï¼Œé»˜è®¤å‘½åä¸º `stats.html`ã€‚

> æç¤ºï¼šæŠŠåˆ†ææ–‡ä»¶åŠ å…¥ `.gitignore` ï¼Œä¸æäº¤åˆ° `git` ä»“åº“ä¸­

## æ‰“åŒ…é…ç½®

@See https://cn.vitejs.dev/config/shared-options.html#esbuild

ç”Ÿäº§ç¯å¢ƒå»é™¤ console.log ã€debugger

```ts
import { defineConfig } from "vite";
export default defineConfig({
  esbuild: {
    drop: ['debugger'],
    pure: ['console.log']
  }
});
```

# é¡¹ç›®é…ç½®

## å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒæ£€æŸ¥ä¸ä¿®å¤

ä»£ç è§„èŒƒï¼šlintå·¥å…·ï¼ˆ**eslint**ï¼‰

### ä»£ç é£æ ¼ prettier

1ï¼‰å®‰è£…

```shell
$ pnpm add -D prettier
```

2ï¼‰ æ–°å»º `.prettierrc.json` é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®ï¼š

```js
{
 "printWidth": 80,
 "tabWidth": 2,
 "useTabs": true,
 "singleQuote": true,
 "semi": true,
 "trailingComma": "none",
 "bracketSpacing": true
}
```

â‘¢ å°† `prettier` é›†æˆåˆ° `eslint` ä¸­ï¼Œå…¶ä¸­ï¼š

- `eslint-config-prettier`ï¼šè¦†ç›– `ESLint` æœ¬èº«çš„è§„åˆ™é…ç½®
- `eslint-plugin-prettier`ï¼šç”¨ `Prettier` æ¥æ¥ç®¡ä¿®å¤ä»£ç å³ `eslint --fix`

```shell
$ pnpm add -D eslint-config-prettier eslint-plugin-prettier
```

â‘£ ä¸º `lint` å¢åŠ å¯¹åº”çš„æ‰§è¡Œè„šæœ¬ï¼š

```json
"lint": "eslint --fix --quiet .",
```

- `eslint`ï¼šè°ƒç”¨ ESLint ä»£ç æ£€æŸ¥å·¥å…·ã€‚
- `--fix`ï¼šè‡ªåŠ¨ä¿®å¤å¯ä¿®å¤çš„é”™è¯¯ï¼ˆä¾‹å¦‚ä»£ç æ ¼å¼ã€ç®€å•çš„è¯­æ³•é—®é¢˜ï¼‰ã€‚
- `--quiet`ï¼šåªæŠ¥å‘Šé”™è¯¯ï¼ˆå¿½ç•¥è­¦å‘Š warningsï¼‰ï¼Œå‡å°‘è¾“å‡ºä¿¡æ¯ã€‚
- `.`ï¼šè¡¨ç¤ºæ£€æŸ¥å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚

åŒæ—¶ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£… [`prettier`](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode) ä¸ [ `eslint`](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint) çš„ VSCode æ’ä»¶ï¼Œå¹¶åœ¨ `setting` ä¸­è®¾ç½®ä¸ºä¿å­˜åè‡ªåŠ¨æ‰§è¡Œã€‚

Editor: Default Formatter  â€”â€” Prettier - Code formatter

Editor:Format On Save â€”â€” â˜‘ï¸ ä¿å­˜æ—¶è®¾ç½®æ–‡ä»¶æ ¼å¼

5ï¸âƒ£ æµ‹è¯•

### commit è§„èŒƒæ£€æŸ¥

åœ¨ Vite é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡é…ç½® `commitlint` + [`husky`](https://typicode.github.io/husky/) + `lint-staged` æ¥**è§„èŒƒ Git æäº¤ä¿¡æ¯**ã€**è‡ªåŠ¨æ‰§è¡Œä»£ç è´¨é‡æ£€æŸ¥**ï¼Œä»¥åŠ**ä¼˜åŒ– Git Hook æ‰§è¡Œæ•ˆç‡**ã€‚

1ï¸âƒ£ **å®‰è£…ä¾èµ–**

å®‰è£…å¿…è¦çš„ä¾èµ–ï¼š

```shell
$ pnpm add -D husky lint-staged @commitlint/{cli,config-conventional}
```

2ï¸âƒ£ **åˆå§‹åŒ– husky**

åˆå§‹åŒ– `husky`ï¼Œè¿™ä¼šè‡ªåŠ¨åˆ›å»º `.husky` ç›®å½•å¹¶è®¾ç½® Git Hookï¼š

```shell
$ pnpm exec husky init
```

3ï¸âƒ£ **é…ç½® `pre-commit` é’©å­**

é…ç½® `pre-commit` é’©å­ï¼Œåœ¨æäº¤æ—¶è¿è¡Œ `lint-staged`ï¼Œåªæ£€æŸ¥æš‚å­˜åŒºçš„æ–‡ä»¶ï¼š

```shell
$ echo "npx lint-staged" > .husky/pre-commit && chmod +x .husky/pre-commit
```

åœ¨ `package.json` ä¸­é…ç½® `lint-staged`ï¼š

```json
"lint-staged": {
  "*.{js,jsx,ts,tsx}": [
    "pnpm lint"
  ]
}
```

è¿™æ ·ï¼Œå½“ä½ æ‰§è¡Œ `git commit` æ—¶ï¼Œ`lint-staged` ä¼šè‡ªåŠ¨è¿è¡Œ `pnpm lint` æ¥æ£€æŸ¥æš‚å­˜åŒºä¸­çš„æ–‡ä»¶ã€‚

4ï¸âƒ£ é…ç½® `commit-msg` é’©å­

é…ç½® `commit-msg` é’©å­ï¼Œæ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒï¼š

```shell
$ echo "npx --no-install commitlint --edit \$1" > .husky/commit-msg && chmod +x .husky/commit-msg
```

åˆ›å»º `.commitlintrc.js` æ–‡ä»¶æ¥é…ç½® `commitlint`ï¼š

```js
export default {
  extends: ["@commitlint/config-conventional"]
};
```

5ï¸âƒ£ **å®Œæˆ**

ç°åœ¨ï¼Œå½“ä½ æ‰§è¡Œ `git commit` æ—¶ï¼Œ`husky` ä¼šè‡ªåŠ¨è§¦å‘ä»¥ä¸‹é’©å­ï¼š

- **`pre-commit` é’©å­**ï¼šè¿è¡Œ `lint-staged`ï¼Œå¯¹æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œä»£ç é£æ ¼æ£€æŸ¥ã€‚
- **`commit-msg` é’©å­**ï¼šè¿è¡Œ `commitlint`ï¼Œæ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚

è¿™æ ·é…ç½®åï¼Œä½ çš„é¡¹ç›®å°†èƒ½å¤Ÿåœ¨æäº¤æ—¶è‡ªåŠ¨è¿›è¡Œä»£ç é£æ ¼å’Œæäº¤ä¿¡æ¯çš„æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œæäº¤ä¿¡æ¯çš„è§„èŒƒæ€§ã€‚

**6ï¸âƒ£ æç¤º**

1. `lint-staged` ä¼šè‡ªåŠ¨å°†ä¿®æ”¹åçš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œå› æ­¤ä¸è¦åœ¨ `lint-staged` é…ç½®ä¸­æ˜¾å¼è°ƒç”¨ `git add`ã€‚
2. å¦‚æœ `pnpm lint` æ£€æŸ¥å¤±è´¥ï¼Œæäº¤ä¼šè¢«é˜»æ­¢ã€‚è¯·æ ¹æ®é”™è¯¯æç¤ºä¿®å¤ä»£ç åé‡æ–°æäº¤ã€‚
3. å¦‚æœéœ€è¦è‡ªå®šä¹‰æäº¤ä¿¡æ¯è§„èŒƒï¼Œå¯ä»¥ä¿®æ”¹ `.commitlintrc.js` æ–‡ä»¶ï¼Œæ·»åŠ è‡ªå®šä¹‰è§„åˆ™ã€‚

## æ ·å¼

### less & sass
Vite å†…ç½®å¯¹ Less å’Œ Sass çš„æ”¯æŒï¼Œå®‰è£…å¯¹åº”çš„åŒ…åå³å¯ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

```shell
# å®‰è£… Less
$ pnpm add -D less 

# å®‰è£… Sass
$ pnpm add -D sass 
```

### tailwindcss

> è‹±æ–‡å®˜ç½‘ï¼ˆæ¨èï¼‰ï¼šhttps://tailwindcss.com/
>
> ä¸­æ–‡å®˜ç½‘ï¼šhttps://www.tailwindcss.cn/

1. å®‰è£… Tailwind CSS

```shell
$ pnpm add tailwindcss @tailwindcss/vite
```

2. é…ç½® Vite æ’ä»¶ï¼šåœ¨ vite.config.ts é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  @tailwindcss/vite æ’ä»¶

```js
import { defineConfig } from 'vite'
import tailwindcss from '@tailwindcss/vite'
export default defineConfig({
  plugins: [
    ...
    tailwindcss(),
  ],
})
```

3. å¯¼å…¥ Tailwind CSSï¼šåœ¨æ‚¨çš„ CSS æ–‡ä»¶ï¼ˆ*é€šå¸¸æ˜¯ index.css*ï¼‰ä¸­å¯¼å…¥ Tailwind CSS çš„å†…å®¹

```js
@import "tailwindcss";
```

> ğŸ”– **æç¤º**ï¼šå¦‚æœä½ ä½¿ç”¨ PostCSSï¼Œè¯·å‚è€ƒ [è¿™é‡Œ >>](https://tailwindcss.com/docs/installation/using-postcss)

## mockjs

**â‘ . å®‰è£…ä¾èµ–ï¼š**

```shell
$ pnpm add -D mockjs vite-plugin-mock
```

**â‘¡. å¼•å…¥æ’ä»¶**

> **`vite.config.ts`**

```js
import { defineConfig } from "vite";
import { viteMockServe } from "vite-plugin-mock";

export default defineConfig(({ mode }) => {
  return {
    ...
    plugins: [viteMockServe()],
  };
});

```

**â‘¢. æ–°å»º <u>mock/test.ts</u> æ–‡ä»¶**

```js
// @ts-ignore
import { mock } from "mockjs";

export default [
  {
    url: "/api/user/:id",
    method: "GET",
    response: (req: any) => {
      return mock({
        code: 200,
        data: {
          id: "@guid",
          name: "@cname",
          avatar: "@Image('30x30','@color')",
        },
        msg: "success",
      });
    },
  },
];
```

> æç¤ºï¼šåœ¨å¼•å…¥ `mockjs` æ—¶ï¼Œæˆ‘æ·»åŠ äº† `@ts-ignore`ï¼Œå› ä¸ºåœ¨ `mockjs^1.1.0` ä¸­ï¼Œå¯¼å‡ºçš„æ˜¯ `Mock`ï¼Œ`M` æ˜¯å¤§å†™å­—æ¯ï¼Œå®é™…åœ¨è°ƒç”¨çš„æ—¶å€™æ˜¯å°å†™ã€‚

**â‘£. æ¨¡æ‹Ÿè¯·æ±‚**

```ts
fetch("api/user/1")
  .then((resp) => resp.json())
  .then((info) => {
    console.log(info);
  });
```

## axios

**â‘ . å®‰è£…ç›¸å…³ä¾èµ–ï¼š**

```shell
$ pnpm add axios antd @likg/tools
```

**â‘¡. æ–°å»ºç›®å½•**

```shell
$ mkdir -p src/api/{apiConfig,apiServer} && touch src/api/apiConfig/{index.ts,axios-type.d.ts} src/api/apiServer/{index.ts,apiExamples.ts} src/api/typings.d.ts
```

ç”Ÿæˆç›®å½•å¦‚ä¸‹ï¼š

```ini
.
â”œâ”€â”€ api
    â”œâ”€â”€ apiConfig
    â”‚   â”œâ”€â”€ axios-type.d.ts
    â”‚   â””â”€â”€ index.ts
    â”œâ”€â”€ apiServer 
    â”‚   â”œâ”€â”€ apiExamples.ts
    â”‚   â””â”€â”€ index.ts
    â””â”€â”€ typings.d.ts
```

> **`apiConfig/axios-type.d.ts`**

```ts
import 'axios';

declare module 'axios' {
  export interface AxiosResult<T = unknown> {
    code: number;
    data: T;
    msg: string;
  }
}
```

> **`apiConfig/index.ts`**

```ts
import Tools from "@likg/tools";
import axios, {
  AxiosError,
  AxiosInstance,
  AxiosResponse,
  AxiosResult,
  AxiosRequestConfig,
  InternalAxiosRequestConfig,
} from "axios";
import { message } from "antd";


// ~~~~~~~~~~~~~~~~~~~~~~~
// é”™è¯¯ä¿¡æ¯
// ~~~~~~~~~~~~~~~~~~~~~~~
const errorMessages: Record<number, string> = {
  400: "è¯·æ±‚é”™è¯¯(400)",
  401: "æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•(401)",
  403: "æ‹’ç»è®¿é—®(403)",
  404: "è¯·æ±‚å‡ºé”™(404)",
  405: "è¯·æ±‚æ–¹æ³•ä¸æ”¯æŒ(405)",
  408: "è¯·æ±‚è¶…æ—¶(408)",
  500: "æœåŠ¡å™¨å¼‚å¸¸(500)",
  501: "æœåŠ¡æœªå®ç°(501)",
  502: "ç½‘ç»œé”™è¯¯(502)",
  503: "ç½‘ç»œè¶…æ—¶(503)",
  504: "ç½‘ç»œè¶…æ—¶(504)",
  505: "HTTP ç‰ˆæœ¬ä¸å—æ”¯æŒ(505)",
};

// ~~~~~~~~~~~~~~~~~~~~~~~
// åˆ›å»º axios å®ä¾‹
// ~~~~~~~~~~~~~~~~~~~~~~~
const axiosInstance: AxiosInstance = axios.create({
  baseURL: import.meta.env.VITE_API_HOST,
  timeout: 60 * 1000,
  withCredentials: false,
  headers: {
    "Access-Control-Allow-Origin": "*",
    "Content-Type": "application/json",
  },
});


// ~~~~~~~~~~~~~~~~~~~~~~~
// è¯·æ±‚æ‹¦æˆªå™¨
// ~~~~~~~~~~~~~~~~~~~~~~~
axiosInstance.interceptors.request.use(
  (config: InternalAxiosRequestConfig) => {

    // -- æ‹¼æ¥token
    const token = localStorage.getItem("AUTHORIZATION_TOKEN") ?? "";
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }

    // -- ç¡®è®¤å¹³å°
    // -- å¦‚æœåŒæ—¶å¼€å‘æ”¯ä»˜å®/å¾®ä¿¡å…¬ä¼—å·/H5åˆ™éœ€è¦ä¼ å…¥æ¥æº
    // -- æ³¨æ„ï¼šå…·ä½“å€¼è¯·ä¸åç«¯é…åˆå•†è®®å¯¹åº”å¹³å°çš„sourceå€¼
    const platforms: Record<string, string> = {
      alipay: "MP_ALIPAY",
      weixin: "MP_WEIXIN",
    };
    const source = platforms[Tools.getEnv()] || "WEB";
    config.headers.source = source;

    // -- è¿”å›é…ç½®
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);



// ~~~~~~~~~~~~~~~~~~~~~~~
// å“åº”æ‹¦æˆªå™¨
// ~~~~~~~~~~~~~~~~~~~~~~~
axiosInstance.interceptors.response.use(
  async (response: AxiosResponse) => {
    message.destroy();
    // -- å¤„ç†æµæ•°æ®
    if (response.request.responseType === "blob") {
      return { code: 200, data: response.data, msg: "success" };
    }
    // -- åˆ¤æ–­codeï¼Œç»Ÿä¸€å¤„ç†å¼‚å¸¸
    const { code, msg } = response.data as unknown as AxiosResult;
    switch (code) {
      case 200:
        return response.data;
      case 401:
      case 402:
        // history.replace('/login');
        return Promise.reject();
      default:
        message.error(msg || 'è¯·æ±‚å‡ºé”™å•¦');
        return Promise.reject(msg);
    }
  },
  (error: AxiosError) => {
    console.log("[request error] > ", error);
    if (error && error.response) {
      const status = error.response?.status;
      const errorMessage = errorMessages[status] || `è¿æ¥å‡ºé”™(${status})!`;
      error.message = errorMessage;
    } else {
      error.message = "æœåŠ¡é“¾æ¥å¤±è´¥";
    }
    message.error(error.message);
    return Promise.reject(error);
  }
);

// ~~~~~~~~~~~~~~~~~~~~~~~
// ç»Ÿä¸€çš„ request æ–¹æ³•
// ~~~~~~~~~~~~~~~~~~~~~~~
const request = <R = unknown>(options: AxiosRequestConfig): Promise<AxiosResult<R>> => {
  return axiosInstance(options);
};
export default request;
```

> **`typings.d.ts`**

```ts
declare namespace API {
  // ~~~~~~~~~~~~~~~~~~
  // åˆ—è¡¨æ•°æ®
  // ~~~~~~~~~~~~~~~~~~
  interface ListParams {
    page?: number;
    size?: number;
    [__prop__: string]: unknown;
  }
  interface ListResponse<T> {
    items: T[];
    page: number;
    size: number;
    count: number;
  }
}
```

æç¤ºï¼šè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®šä¹‰ä¸€äº›æ¥å£è¯·æ±‚æˆ–å“åº”çš„æ•°æ®ç±»å‹ã€‚

> **`apiServer/apiExamples.ts`**

```ts
import request from "@/api/apiConfig";

export async function posts() {
  return request<unknown>({
    url: '/posts',
  });
}
```

æç¤ºï¼šè¿™ä¸ªæ–‡ä»¶ä¸»è¦å®šä¹‰å®é™…ä¸šåŠ¡éœ€æ±‚ä¸­çš„æ¥å£ï¼Œä½ åº”è¯¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯åˆ›å»ºä¸åŒçš„æ–‡ä»¶ï¼Œæ–‡ä»¶åä¹‰ `apiXXX` å¼€å¤´ã€‚

> **`apiServer/index.ts`**

```ts
import * as apiExamples from "./apiExamples";
export { apiExamples };
```

æç¤ºï¼šè¿™ä¸ªæ–‡ä»¶ä¸»è¦æ˜¯ç»Ÿä¸€å¯¼å‡ºæ¥å£è¯·æ±‚ã€‚

è°ƒç”¨ï¼š

```vue
import { apiExamples } from '@/api/apiServer';
import { useEffect } from 'react';

export default function App() {
	useEffect(() => {
		const fetchData = async () => {
			const resp = await apiExamples.posts();
			console.log(resp.data);
		};
		fetchData();
	}, []);
	return <></>;
}
```

## å…¨å±€ç±»å‹å£°æ˜

æœ‰æ—¶ï¼Œå½“æˆ‘ä»¬å¼•å…¥ä¸‰æ–¹SDKæ—¶ï¼Œéœ€è¦åœ¨windowä¸Šè®¿é—®ï¼Œå¯ä»¥å®šä¹‰å…¨å±€ç±»å‹å£°æ˜ï¼š

> **`@/typings/index.d.ts`**

```ts
export {};

// -- å…¨å±€ç»„ä»¶å±æ€§å®šä¹‰
import { FiltersProps } from "@/filters";
declare module "@vue/runtime-core" {
  interface ComponentCustomProperties {
    $filters: FiltersProps;
  }
}

declare global {
  // ğŸ‘‰ å®šä¹‰å…¨å±€å±æ€§
  interface Window {
    /** ç™¾åº¦ç»Ÿè®¡ */
    _hmt: any;
    /** å¾®ä¿¡S*/
    wx: any;
    /** ç™¾åº¦åœ°å›¾ */
    AMap: any;
    /** è…¾è®¯åœ°å›¾ */
    qq: any;
    /** æ”¯ä»˜å® */
    AlipayJSBridge: any;
    /** iOSå›è°ƒåœ°å€ */
    CONFIG_URL_FOR_IOS: string;
  }
}

```

## åŠ¨æ€åŠ è½½é™æ€èµ„æº

åœ¨ä½¿ç”¨ webpack åŠ¨æ€å¼•å…¥é™æ€èµ„æºå¯ä»¥ä½¿ç”¨ `require` å½¢å¼ï¼Œä½†æ˜¯åœ¨viteä¸­ä¸å¯å–ï¼Œä¼šæŠ›å‡º <u>*require is not defined*</u> çš„é”™è¯¯ã€‚

ä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ [import.meta.url](https://cn.vitejs.dev/guide/assets.html#new-url-url-import-meta-url) çš„å½¢å¼å¼•å…¥ï¼Œå®ƒæ˜¯ä¸€ä¸ª ESM çš„åŸç”ŸåŠŸèƒ½ï¼Œä¼šæš´éœ²å½“å‰æ¨¡å—çš„ URLã€‚å°†å®ƒä¸åŸç”Ÿçš„ [URL æ„é€ å™¨](https://developer.mozilla.org/en-US/docs/Web/API/URL) ç»„åˆä½¿ç”¨ï¼Œåœ¨ä¸€ä¸ª JavaScript æ¨¡å—ä¸­ï¼Œé€šè¿‡ç›¸å¯¹è·¯å¾„æˆ‘ä»¬å°±èƒ½å¾—åˆ°ä¸€ä¸ªè¢«å®Œæ•´è§£æçš„é™æ€èµ„æº URLï¼Œå…¶è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š

```js
new URL(url, import.meta.url)
```

ä½¿ç”¨ç¤ºä¾‹ï¼š

```js
const imgs = [
  { imgUrl: new URL('./assets/logo_1.png', import.meta.url), text: "æ ‡é¢˜1" },
  { imgUrl: new URL('./assets/logo_2.png', import.meta.url), text: "æ ‡é¢˜2" },
];
```

```react
// => react
{imgs.map((item) => (
  <img src={item.imgUrl.toString()} key={item.title} />
))}
```

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¼šæŠ›å‡º â€œ*URL is not defined xxx*â€  çš„é”™è¯¯ï¼Œè¿™ä¸ªæ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ’ä»¶ï¼š[rollup-plugin-import-meta-url-to-module](https://www.npmjs.com/package/rollup-plugin-import-meta-url-to-module)ã€‚

ä½¿ç”¨æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œé¦–å…ˆå®‰è£…ä¾èµ–ï¼š

```shell
$ yarn add rollup-plugin-import-meta-url-to-module
```

ç„¶åå† â€œ*vit.config.js*â€ ä¸­é…ç½®pluginsï¼š

```js
import urlToModule from 'rollup-plugin-import-meta-url-to-module';

export default {
  plugins: [
    urlToModule()
  ]
};
```

## ç§»åŠ¨ç«¯é…ç½®ï¼ˆå¯é€‰ï¼‰

### vconsole

[vconsole](https://github.com/Tencent/vConsole/blob/dev/README_CN.md) æ˜¯ä¸€ä¸ªè½»é‡ã€å¯æ‹“å±•ã€é’ˆå¯¹æ‰‹æœºç½‘é¡µçš„å‰ç«¯å¼€å‘è€…è°ƒè¯•é¢æ¿ã€‚

```shell
$ pnpm add -D vconsole
```

> **`main.ts`**

```ts
if (import.meta.env.VITE_ENV !== "prod") {
  new vconsole();
}
```

### ç§»åŠ¨ç«¯é€‚é…

```shell
$ pnpm add -D postcss-pxtorem autoprefixer 
```

**`postcss.config.js`**

```js
export default {
  plugins: {
    autoprefixer: {
      overrideBrowserslist: [
        "Android 4.1",
        "iOS 7.1",
        "Chrome > 31",
        "ff > 31",
        "ie >= 8",
      ],
    },
    "postcss-pxtorem": {
      // -- Vant å®˜æ–¹æ ¹å­—ä½“å¤§å°æ˜¯ 37.5
      rootValue: 37.5,
      propList: ["*"],
      // -- è¿‡æ»¤æ‰.norem-å¼€å¤´çš„classï¼Œä¸è¿›è¡Œremè½¬æ¢
      selectorBlackList: [".norem"],
    },
  },
};
```

**`@/utils/rem.ts`**

```ts
//Â rem ç­‰æ¯”é€‚é…é…ç½®æ–‡ä»¶
//Â åŸºå‡†å¤§å°ï¼Œæ³¨æ„æ­¤å€¼è¦ä¸Â postcss.config.jsÂ æ–‡ä»¶ä¸­çš„Â rootValueä¿æŒä¸€è‡´
const baseSize = 37.5;
//Â è®¾ç½®Â remÂ å‡½æ•°
function setRem() {
  //Â å½“å‰é¡µé¢å®½åº¦ç›¸å¯¹äº375å®½çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œå¯æ ¹æ®è‡ªå·±éœ€è¦ä¿®æ”¹,ä¸€èˆ¬è®¾è®¡ç¨¿éƒ½æ˜¯å®½750(å›¾æ–¹ä¾¿å¯ä»¥æ‹¿åˆ°è®¾è®¡å›¾åæ”¹è¿‡æ¥)ã€‚
  const scale = document.documentElement.clientWidth / 375; //Â è®¾ç½®é¡µé¢æ ¹èŠ‚ç‚¹å­—ä½“å¤§å°ï¼ˆâ€œMath.min(scale,Â 2)â€Â æŒ‡æœ€é«˜æ”¾å¤§æ¯”ä¾‹ä¸º2ï¼Œå¯æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ï¼‰
  document.documentElement.style.fontSize = baseSize * Math.min(scale, 2) + "px";
}
//Â åˆå§‹åŒ–
setRem();
//Â æ”¹å˜çª—å£å¤§å°æ—¶é‡æ–°è®¾ç½®Â rem
window.onresize = function () {
  setRem();
};
```

åœ¨ `mian.ts(x)`  å¼•å…¥ï¼š

```ts
import "@/utils/rem";
```

> å¦‚æœæ§åˆ¶å°æŠ›å‡ºï¼šã€æ— æ³•åœ¨ `--isolatedModules` ä¸‹ç¼–è¯‘ `rem.ts`ï¼Œå› ä¸ºå®ƒè¢«è§†ä¸ºå…¨å±€è„šæœ¬æ–‡ä»¶ã€‚è¯·æ·»åŠ å¯¼å…¥ã€å¯¼å‡ºæˆ–ç©ºçš„  `export {}` è¯­å¥æ¥ä½¿å®ƒæˆä¸ºæ¨¡å—ã€‘æ­¤æ—¶ä½ åº”è¯¥åœ¨ `tsconfig.json` æ–‡ä»¶ä¸­å°† `isolatedModules` å­—æ®µè®¾ç½®ä¸º `false`ã€‚

# å·®å¼‚åŒ–é…ç½®

## ğŸ“– Vue.js

### è·¯ç”±é…ç½®

å®‰è£…ä¾èµ–ï¼š

```shell
$ pnpm add vue-router
```

æ–°å»ºæ–‡ä»¶ï¼š

```shell
$ mkdir -p src/router && touch src/router/index.ts src/router/routes.ts
```

> **`routes.ts`**

```ts
import { RouteRecordRaw } from "vue-router";

import Layouts from "@/layouts/index.vue";

const routes: RouteRecordRaw[] = [
  {
    path: "/",
    name: "layouts",
    redirect: "/index-page",
    component: Layouts,
    children: [
      {
        path: "/index-page",
        name: "index",
        component: () => import("@/pages/Tabs/IndexPage.vue"),
        meta: { title: "é¦–é¡µ" },
      },
      {
        path: "/special-sale",
        name: "SpecialSale",
        component: () => import("@/pages/Tabs/SpecialSale.vue"),
        meta: { title: "ç‰¹å–" },
      },
      {
        path: "/friends",
        name: "Friends",
        component: () => import("@/pages/Tabs/Friends.vue"),
        meta: { title: "å¥½å‹" },
      },
      {
        path: "/mine",
        name: "Mine",
        component: () => import("@/pages/Tabs/Mine.vue"),
        meta: { title: "æˆ‘çš„" },
      },
    ],
  },
  {
    path: "/download",
    name: "Download",
    component: () => import("@/pages/Download/index.vue"),
    meta: {
      title: "ä¸‹è½½",
    },
  },
  {
    path: "/not-found",
    name: "NotFound",
    component: () => import("@/pages/NotFound/index.vue"),
  },
  {
    path: "/:pathMatch(.*)",
    redirect: "/not-found",
  },
];

export default routes;

```

> **`index.ts`**

```ts
import { createRouter, createWebHistory } from "vue-router";
import routes from "./routes";

const router = createRouter({
  // -- éƒ¨ç½²äºŒçº§ç›®å½•ï¼šcreateWebHistory(base?: string)
  history: createWebHistory(import.meta.env.VITE_BASE),
  // -- è·¯ç”±
  routes,
  // -- æ»šåŠ¨è¡Œä¸º
  scrollBehavior: () => ({
    el: "#app",
    top: 0,
    behavior: "smooth",
  }),
});

// å¯¼èˆªå®ˆå«
router.beforeEach(async (to, _) => {});

router.afterEach((to) => {
  // â†’ è®¾ç½®æ ‡é¢˜
  if (to.path !== "/favicon.icon") {
    document.title = to.meta.title ? (to.meta.title as string) : "";
  }
  // â†’ æ»šåŠ¨
  window.scrollTo(0, 0);
});

export default router;

```

> æç¤ºï¼šè¿™é‡Œåªæ˜¯ç®€å•æ¼”ç¤ºå¦‚ä½•é…ç½®è·¯ç”±ï¼Œå®é™…ä¸Šä½ åº”è¯¥æ ¹æ®ä½ çš„ä¸šåŠ¡éœ€æ±‚æ¥é…ç½®ã€‚å…³äº vue-router çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ [è¿™é‡Œ >>](https://router.vuejs.org/)

åœ¨main.tsæŒ‚è½½è·¯ç”±

```ts
import App from "@/App.vue";
import router from "@/router";

// Appé…ç½®/æŒ‚è½½ç›¸å…³
// 1. åˆ›å»ºApp
const app = createApp(App);
// 2. æ³¨å…¥
app.use(router);
// 3. æŒ‚è½½
app.mount("#app");
```

### çŠ¶æ€ç®¡ç†

```shell
$ pnpm add pinia
```

> æç¤ºï¼šå…³äº Pinia çš„ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ [è¿™é‡Œ >>](https://pinia.vuejs.org/zh/)

**`@/stores/index.ts`**

```ts
import { defineStore } from 'pinia';

interface StoreProps {
  count: number;
}

interface ActionProps {
  increment: () => void;
  decrement: () => void;
}

export const useStore = defineStore<string, StoreProps, any, ActionProps>(
  'appStore',
  {
    state: () => ({ count: 0 }),
    actions: {
      async increment() {},
      async decrement() {},
    },
  }
);
```

æŒ‚è½½ï¼šåœ¨main.tsæŒ‚è½½æ•°æ®ä¸­å¿ƒ

```ts
import { createApp } from "vue";
import { createPinia } from "pinia";
import { useStore } from "@/stores";
import App from "@/App.vue";

// ğŸ‘‰ app
// 1. åˆ›å»ºapp
const app = createApp(App);
// 2. æ³¨å…¥ä¾èµ–
app.use(createPinia());

// 4. æŒ‚åœ¨app
app.mount("#app");

// ğŸ‘‰ æŒä¹…åŒ–pinia
const store = useStore();
// é¡µé¢è¿›å…¥ï¼šåˆå¹¶çŠ¶æ€
const localState = localStorage.getItem("PINIA_PERSISTENCE");
if (localState) {
  console.log("[æ¸©é¦¨æç¤º]ï¼šåˆå¹¶Store...");
  store.$state = JSON.parse(localState);
}
// é¡µé¢åˆ·æ–°ï¼šå­˜å‚¨çŠ¶æ€
window.addEventListener("beforeunload", () => {
  console.log("[æ¸©é¦¨æç¤º]ï¼šç¼“å­˜Store...");
  localStorage.setItem("PINIA_PERSISTENCE", JSON.stringify(store.$state));
});

```

### Vant

[Vant](https://vant.pro/vant/#/zh-CN) æ˜¯ä¸€ä¸ª**è½»é‡ã€å¯å®šåˆ¶çš„ç§»åŠ¨ç«¯ç»„ä»¶åº“**ï¼ŒVue é¦–é€‰ç§»åŠ¨ç«¯UIæ¡†æ¶ï¼Œ

```shell
$ pnpm add vant
```

> æç¤ºï¼šé…ç½®æŒ‡å—ï¼Œå‚è€ƒ [è¿™é‡Œ >>](https://vant.pro/vant/#/zh-CN/quickstart)

**â‘ . å®‰è£…ä¾èµ–**

```shell
$ pnpm add @vant/auto-import-resolver unplugin-vue-components -D
```

**â‘¡ . é…ç½®æ’ä»¶**

> **`vite.config.ts`**

```ts
import { defineConfig } from "vite";
import { VantResolver } from "@vant/auto-import-resolver";
import Components from "unplugin-vue-components/vite";

export default defineConfig(({ mode }) => {
  return {
    plugins: [
    	...
      Components({
        resolvers: [VantResolver()],
      }),
    ],
  };
});
```

> æç¤ºï¼šæœ‰èµå›¢é˜Ÿä¹Ÿæä¾›äº†React ç‰ˆæœ¬ â€”â€” [React Vant >>](https://react-vant.3lang.dev/)

### äºŒçº§ç›®å½•éƒ¨ç½²

**æ–¹æ¡ˆ1ï¼š**

æ‰“åŒ…æ—¶è®¾ç½® `-base` é€‰é¡¹ï¼š

```js
"build": "vue-tsc --noEmit && vite build --mode production --base=/äºŒçº§ç›®å½•å/",
```

ç„¶åå† `router/index.ts` ä¸­é…ç½®å¦‚ä¸‹ï¼š

```js
const router = createRouter({
  // éƒ¨ç½²äºŒçº§ç›®å½•ï¼šcreateWebHistory(base?: string)
  history: createWebHistory("/äºŒçº§ç›®å½•å/"),
  routes,
});
```

**æ–¹æ¡ˆ2ï¼š**

åœ¨ `vite.config.js` é…ç½®é¡¹ä¸­æ·»åŠ  `base` é…ç½®ï¼Œå¦‚ï¼š

```js
base:"/YOUR_PROJECT_NAME/"
```

ç„¶åå† `router/index.ts` ä¸­é…ç½®å¦‚ä¸‹ï¼š

```js
const router = createRouter({
  // éƒ¨ç½²äºŒçº§ç›®å½•ï¼šcreateWebHistory(base?: string)
  history: createWebHistory("/äºŒçº§ç›®å½•å/"),
  routes,
});
```

## ğŸ“– React

### è·¯ç”±é…ç½®

**â‘ . ç›®å½•ç»“æ„**

```ini
.
â”œâ”€â”€ components
â”‚   â”œâ”€â”€ Fallback # æ‡’åŠ è½½loadingæç¤º 
â”‚   â”œâ”€â”€ NotEnv   # éå¾®ä¿¡/æ”¯ä»˜å®ç¯å¢ƒæç¤º
â”‚	  â””â”€â”€ TabBar   # æ ‡ç­¾æ 
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ index.less
â”œâ”€â”€ layouts
â”‚	  â””â”€â”€ index.tsx
â”œâ”€â”€ pages
â”‚   â”œâ”€â”€ Auth
â”‚   â”œâ”€â”€ IndexPage
â”‚   â”œâ”€â”€ Integral
â”‚   â”œâ”€â”€ Mine
â”‚   â”œâ”€â”€ NotFound
â”‚	  â””â”€â”€ PrivilegeBrand
â”œâ”€â”€ router
â”‚   â”œâ”€â”€ index.tsx
â”‚	  â””â”€â”€ routes.ts
â””â”€â”€ main.tsx
```

> æç¤ºï¼šè¿™é‡Œåªä¾‹ä¸¾éƒ¨åˆ†ç›®å½•ï¼Œä»…ä¾›å‚è€ƒã€‚

**â‘¡. å®‰è£…ä¾èµ–**

```shell
$ pnpm add react-router-dom
```

> æç¤ºï¼šç›®å‰æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ `^6.23.1`ï¼Œå…³äº v6 ç‰ˆæœ¬çš„è·¯ç”±ä½¿ç”¨è¯· [å‚è€ƒè¿™é‡Œ >>](https://reactrouter.com/)

**â‘¢. æ–‡ä»¶ä»£ç **

> `src/layout/index.tsx`

```tsx
import TabBar from '@/components/@lgs-react/TabBar';
import React from 'react';
import { Outlet } from 'react-router-dom';

const Layout: React.FC = () => {
  return (
    <>
      {/* è§†å›¾å®¹å™¨ï¼Œç±»ä¼¼äºvueä¸­çš„ router-view */}
      <Outlet />
      {/* æ ‡ç­¾æ  */}
      <TabBar />
    </>
  );
};

export default Layout;
```

> `src/App.tsx`

```tsx
import React, { Suspense } from 'react';
import { BrowserRouter as Router, Route, Routes } from 'react-router-dom';

import Fallback from '@/components/@lgs-react/Fallback';
import Layout from '@/layout';
import IndexPage from '@/pages/IndexPage';
import Integral from '@/pages/Integral';
import Mine from '@/pages/Mine';
import PrivilegeBrand from '@/pages/PrivilegeBrand';
import Auth from '@/pages/Auth';
import NotFound from './pages/NotFound';
import NotEnv from './components/@lgs-react/NotEnv';

import Tools from 'lg-tools';

const Details = React.lazy(() => import('@/pages/Details'));
const Download = React.lazy(() => import('@/pages/Download'));
const Test = React.lazy(() => import('@/pages/Test'));

/**
 * ç¯å¢ƒåˆ¤æ–­
 * å¦‚æœ VITE_APP_SOURCE === 'mp'ï¼Œå³è¡¨ç¤ºå…¬ä¼—å·/ç”Ÿæ´»å·
 * é‚£ä¹ˆåœ¨æµè§ˆå™¨ç¯å¢ƒå°†æç¤º â€œè¯·åœ¨å¾®ä¿¡æˆ–æ”¯ä»˜å®å®¢æˆ·ç«¯æ‰“å¼€é“¾æ¥â€
 * @param param0
 * @returns
 */
export const GuardEnv: React.FC = ({ children }) => {
  return import.meta.env.VITE_APP_SOURCE === 'mp' &&
    ['weixin', 'alipay'].indexOf(Tools.getEnv()) === -1 ? (
    <NotEnv />
  ) : (
    <>{children}</>
  );
};

/**
 * appRouter
 * @returns
 */
export const AppRouter: React.FC = ({ children }) => {
  return (
    <Suspense fallback={Fallback}>
      <Router basename={import.meta.env.VITE_APP_BASE}>{children}</Router>
    </Suspense>
  );
};

/**
 * appRoutes - æ¸²æŸ“è·¯ç”±
 * @returns
 */
export const AppRoutes: React.FC = () => {
  return (
    <Routes>
      <Route path='/' element={<Layout />}>
        <Route index element={<IndexPage />} />
        <Route path='privilege-brand' element={<PrivilegeBrand />} />
        <Route path='integral' element={<Integral />} />
        <Route path='mine' element={<Mine />} />
      </Route>
      <Route path='/details' element={<Details />} />
      <Route path='/download' element={<Download />} />
      <Route path='/test' element={<Test />} />
      <Route path='/auth/:type' element={<Auth />} />
      <Route path='*' element={<NotFound />} />
    </Routes>
  );
};
```

> `src/main.tsx`

```tsx
import React from 'react';
import ReactDOM from 'react-dom';
import ErrorBoundary from '@/components/@lgs-react/ErrorBoundary';

import '@/utils/rem';
import '@/index.css';
import { AppRouter, AppRoutes, GuardEnv } from './App';
import Schemes from 'lg-schemes';

// 1. å¼€å‘ç¯å¢ƒ & æµ‹è¯•ç¯å¢ƒ å¯ç”¨vconsole --- Tipsï¼šç›®å‰å¯ç”¨vconsoleæ‰“åŒ…ä¼šå‡ºç°å¼‚å¸¸
import vconsole from 'vconsole';
if (import.meta.env.VITE_APP_ENV !== 'pro') {
  new vconsole();
}

// 2. æ¸²æŸ“è§†å›¾
ReactDOM.render(
  <React.StrictMode>
    <ErrorBoundary>
      <GuardEnv>
        <AppRouter>
          <AppRoutes />
        </AppRouter>
      </GuardEnv>
    </ErrorBoundary>
  </React.StrictMode>,
  document.getElementById('root')
);
```

### ç»„ä»¶åº“

#### Ant Design

[Ant Design](https://ant-design.antgroup.com/index-cn) æ˜¯ä¸€æ¬¾åŸºäº React çš„ä¼ä¸šçº§ UI ç»„ä»¶åº“ï¼Œç”±é˜¿é‡Œå·´å·´ Ant Group å¼€å‘ï¼Œä¸»è¦ç”¨äºæ„å»ºç°ä»£åŒ–ã€é«˜æ•ˆã€ä¼˜é›…çš„ä¸­åå°ç®¡ç†ç³»ç»Ÿã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„ UI ç»„ä»¶ã€å¼ºå¤§çš„ä¸»é¢˜å®šåˆ¶èƒ½åŠ›ï¼Œä»¥åŠè‰¯å¥½çš„å›½é™…åŒ–æ”¯æŒï¼Œæ˜¯ React ç”Ÿæ€ä¸­æœ€å—æ¬¢è¿çš„ UI åº“ä¹‹ä¸€ã€‚

1ï¼‰å®‰è£…ä¾èµ–

```shell
$ pnpm add antd
```

2ï¼‰ä½¿ç”¨ï¼šä¿®æ”¹ `src/App.js`ï¼Œå¼•å…¥ antd çš„æŒ‰é’®ç»„ä»¶ã€‚

```tsx
import { Button } from 'antd';

export default function App() {
	return (
		<div>
			<Button type="primary">Button</Button>
		</div>
	);
}
```

> â—ï¸æ³¨æ„ï¼š
>
> æˆªæ­¢åˆ°å‘æ–‡ï¼Œ Ant ç³»åˆ—æš‚æ—¶è¿˜æœªå®Œå…¨é€‚é… React 19ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæœ‰è­¦å‘Šç”šè‡³é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
>
> *Warning: [antd: compatible] antd v5 support React is 16 ~ 18. see https://u.ant.design/v5-for-19 for compatible.*
>
> å®˜æ–¹å·²ç»æ¨å‡ºäº†å…¼å®¹æ–¹æ¡ˆï¼ˆå‚è€ƒ [è¿™é‡Œ >>](https://ant.design/docs/react/v5-for-19-cn/)ï¼‰ï¼Œå°±æ˜¯å®‰è£…å…¼å®¹åŒ…  @ant-design/v5-patch-for-react-19

3ï¼‰è®¾ç½®ç»„ä»¶é»˜è®¤è¯­è¨€ä¸ºä¸­æ–‡

```tsx
import { ConfigProvider } from 'antd';
import zhCN from 'antd/locale/zh_CN'; // å¼•å…¥ä¸­æ–‡è¯­è¨€åŒ…

ReactDOM.createRoot(document.getElementById("root")!).render(
  <React.StrictMode>
    <ConfigProvider locale={zhCN}>
      <App />
    </ConfigProvider>
  </React.StrictMode>
);Ã
```



#### Ant Design Mobile

[Ant Design Mobile](https://mobile.ant.design/zh) æ˜¯ Ant Design çš„ç§»åŠ¨ç«¯ç‰ˆæœ¬ï¼Œå®ƒç»§æ‰¿äº† Ant Design ä¼˜ç§€çš„è®¾è®¡ç†å¿µï¼Œæ‹¥æœ‰ä¸°å¯Œçš„é«˜è´¨é‡ç§»åŠ¨ç«¯ç»„ä»¶ï¼Œæä¾›è‰¯å¥½çš„äº¤äº’ä½“éªŒå’Œè§†è§‰æ•ˆæœï¼Œæ”¯æŒ React å’Œ Vue ç­‰å¤šç§æŠ€æœ¯æ ˆï¼Œæ–¹ä¾¿é›†æˆåˆ°ç°æœ‰é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”æ³¨é‡æ€§èƒ½ä¼˜åŒ–ä¸å…¼å®¹æ€§ï¼Œé€‚åˆç”¨äºæ„å»ºä¼ä¸šçº§ç§»åŠ¨ç«¯åº”ç”¨ï¼Œèƒ½è®©å¼€å‘ä¿æŒç»Ÿä¸€è®¾è®¡é£æ ¼ä¸”é«˜æ•ˆã€‚

```shell
$ pnpm add antd-mobile
```

> ğŸ’¡æç¤ºï¼šé…ç½®æŒ‡å—ï¼Œå‚è€ƒ [è¿™é‡Œ >>](https://mobile.ant.design/zh/guide/quick-start/)
>

### äºŒçº§ç›®å½•éƒ¨ç½²

**â‘ . åœ¨ `package.json` æ–‡ä»¶ä¸­é…ç½®æŒ‡ä»¤æ—¶æ—¶è®¾ç½® `--base=/äºŒçº§ç›®å½•å/`**ã€‚

**â‘¡. åœ¨å„ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­æ ¹æ®éœ€è¦è®¾ç½® `VITE_APP_BASE` å­—æ®µå€¼**ã€‚

**â‘¡. åœ¨é…ç½®è·¯ç”±æ—¶è®¾ç½® `basename` å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š**

```tsx
/**
 * src/router/index.tsx
 * appRouter
 * @returns
 */
export const AppRouter: React.FC = ({ children }) => {
  return (
    <Suspense fallback={Fallback}>
      <Router basename={import.meta.env.VITE_APP_BASE}>{children}</Router>
    </Suspense>
  );
};
```

# æ¨¡æ¿åœ°å€

é—²æš‡ä¹‹ä½™ï¼Œç»“åˆ `Vite` å°è£…äº†ä¸¤ä¸ªæ¨¡æ¿ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒï¼š

- [Vite6 + Vue3 + TypeScript + Vant4 >>](https://github.com/LiHongyao/vite-vue-template)

- [Vite6 + React19 +_TypeScript + Ant Design Mobile 5.x >>](https://github.com/LiHongyao/vite-react-template)

> æç¤ºï¼šæœ¬æ–‡ä¸­çš„ä»£ç ç‰‡æ®µå‡æ‘˜è‡ªä¸Šè¿°æ¨¡æ¿æ–‡ä»¶ã€‚
